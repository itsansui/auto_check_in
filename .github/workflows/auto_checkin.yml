# 工作流名称（在GitHub Actions页面显示）
name: Auto Checkin Workflow

# 触发条件：推送代码测试 + 定时自动执行
on:
  # 向main分支推送代码时触发（用于测试脚本是否可运行）
  push:
    branches: [ main ]
  # 定时触发（UTC时间，示例：每天20:00执行，对应北京时间次日6:00，可自行调整）
  schedule:
    - cron: '0 22 * * *'

# 定义执行任务
jobs:
  run-checkin-script:
    # 指定运行环境（Ubuntu最新版，兼容性最好）
    runs-on: ubuntu-latest

    # 任务执行步骤
    steps:
      # 步骤1：拉取仓库代码（必选，否则Runner中无脚本文件）
      - name: 拉取仓库代码
        uses: actions/checkout@v4

      # 步骤2：配置Python 3.10环境
      - name: 配置Python 3.10环境
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      # 步骤3：安装脚本依赖（自动识别requirements.txt）
      - name: 安装第三方依赖包
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

      # 步骤4：运行自动签到脚本
      - name: 运行自动签到脚本
        run: python auto_checkin.py
