# 1. 工作流名称（在 GitHub 仓库的 Actions 页面显示）
name: Auto Chenkin Workflow

# 2. 触发条件（Event）：指定哪些事件会触发该工作流
on:
  # 当向 main 分支推送代码时触发（可替换为你的分支名，如 master）
  push:
    branches: [ main ]
  # 可选：当创建针对 main 分支的 PR 时触发
  pull_request:
    branches: [ main ]

# 3. 任务（Job）：一个工作流可以包含多个 Job，这里定义一个名为 build 的 Job
jobs:
  # 任务名称：build（自定义，如 test、deploy 等）
  build:
    # 4. 指定 Runner 运行环境（GitHub 云端 Runner，推荐 Ubuntu latest，兼容性最好）
    runs-on: ubuntu-latest

    # 5. 步骤（Step）：该 Job 要执行的具体操作，按顺序执行
    steps:
      # 步骤1：使用官方 Action 拉取当前仓库的代码到 Runner 环境
      - name: 设置python环境  
        uses: actions/setup-python@v4  # 使用第三方 Action（格式：作者/仓库@版本）
        with: 
          python-version: '3.10'
      # 说明：如果有依赖，需在仓库根目录创建 requirements.txt，写入依赖包名（如 requests==2.31.0）
      
      - name: 安装脚本依赖包
        run: |
          python -m pip install --upgrade pip  # 升级 pip 工具
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi  # 有依赖文件则安装

      # 步骤2：执行命令行脚本
      - name: 运行自动签到脚本
        run: |
          python auto_checkin.py
